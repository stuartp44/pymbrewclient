name: PR Acknowledgment

on:
  pull_request_target:
    types: [opened]

jobs:
  acknowledge:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      - name: Thank contributor
        uses: actions/github-script@v8
        with:
          script: |
            const prAuthor = context.payload.pull_request.user.login;
            const isFirstTime = context.payload.pull_request.author_association === 'FIRST_TIME_CONTRIBUTOR';
            
            let message = `Thanks for opening this pull request, @${prAuthor}!\n\n`;
            
            if (isFirstTime) {
              message += `We're excited to see your first contribution to pymbrewclient!\n\n`;
            }
            
            message += `A maintainer will review your PR soon. In the meantime, please make sure:\n`;
            message += `- [ ] Your code follows the project's style guidelines\n`;
            message += `- [ ] You've added/updated tests as needed\n`;
            message += `- [ ] Your commit messages follow [Conventional Commits](https://www.conventionalcommits.org/)\n`;
            message += `- [ ] You've updated documentation if necessary\n\n`;
            message += `Feel free to ask questions if you need help!`;
            
            github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.payload.pull_request.number,
              body: message
            });

      - name: Add labels
        uses: actions/github-script@v8
        with:
          script: |
            const isFirstTime = context.payload.pull_request.author_association === 'FIRST_TIME_CONTRIBUTOR';
            const labels = ['needs-review'];
            
            if (isFirstTime) {
              labels.push('first-time-contributor');
            }
            
            github.rest.issues.addLabels({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.payload.pull_request.number,
              labels: labels
            });
